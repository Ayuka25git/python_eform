# 可変型入力システム - クイックスタートガイド (PySide6版)

## 概要
このシステムは、設定画面で入力項目を動的に追加すると、入力画面のフォームが自動的に増える仕組みを実装したプロトタイプです。

**現在のバージョン:** DB接続なし版（JSONファイルでデータ管理）
**UIフレームワーク:** PySide6 (Qt for Python)

---

## 必要な環境

- Python 3.8以上
- pip (Pythonパッケージマネージャー)

---

## セットアップ手順

### 1. 依存パッケージのインストール

```bash
pip install PySide6
```

### 2. アプリケーションの起動

```bash
python main.py
```

または

```bash
python3 main.py
```

GUIウィンドウが起動します。

---

## 使い方

### ステップ1: 設定画面で入力項目を追加

1. 「設定画面」タブを選択
2. 「新規項目追加」セクションで以下を入力:
   - **項目名:** 例: 電圧、外観、寸法
   - **データ型:** 文字列、数値、日付から選択
   - **単位:** 例: V, mm, kg (オプション)
   - **必須項目:** チェックを入れると必須項目になります
   - **表示順:** フォームの表示順序を指定
3. 「➕ 追加」ボタンをクリック
4. 複数の項目を追加
5. 「💾 設定を保存」ボタンで保存

**設定例:**

| 項目名 | データ型 | 単位 | 必須 | 表示順 |
|--------|----------|------|------|--------|
| 電圧   | 数値     | V    | ✓    | 1      |
| 電流   | 数値     | A    | ✓    | 2      |
| 外観   | 文字列   | -    | ✓    | 3      |
| 寸法   | 数値     | mm   | ✓    | 4      |
| 検査日 | 日付     | -    | ✓    | 5      |
| 備考   | 文字列   | -    |      | 6      |

### ステップ2: データ入力画面でデータを入力

1. 「データ入力」タブを選択
2. **基本情報**を入力:
   - 日付（デフォルトは今日の日付、カレンダーから選択可能）
   - 品種（例: 製品A）
   - 製造ロット番号（例: LOT-20250101-001）
3. **詳細データ入力**エリアに、設定画面で追加した項目が自動的に表示されます
4. 各項目にデータを入力
5. 「✅ データを登録」ボタンで登録
6. 登録したデータは画面下部の「登録済みデータ」テーブルで確認できます
7. 「詳細」ボタンで各データの詳細を確認できます

---

## 動作確認のポイント

### 動的フォーム生成の確認

1. **設定画面で項目を追加** → 「➕ 追加」→「💾 設定を保存」
2. **データ入力タブに切り替え**
3. **追加した項目が自動的にフォームとして表示される**ことを確認

### データ型ごとの入力フィールド

- **文字列:** テキスト入力フィールド
- **数値:** 数値入力フィールド（スピンボックス、数値以外は入力できない）
- **日付:** 日付ピッカー（カレンダーから選択可能）

### 必須チェック機能

- 必須項目を空欄にして登録しようとすると、エラーメッセージが表示されます

### リアルタイム更新

- 設定画面で「💾 設定を保存」すると、入力画面のフォームが即座に更新されます

---

## ファイル構成

```
帳票（python）/
├── main.py                # メインアプリケーション (PySide6版)
├── config_page_qt.py      # 設定画面モジュール (PySide6版)
├── input_page_qt.py       # 入力画面モジュール (PySide6版)
├── form_config.json       # フォーム設定データ（自動生成）
├── input_data.json        # 入力データ（自動生成）
├── README.md              # 要件定義書
└── QUICKSTART.md          # このファイル
```

**旧Streamlit版ファイル（不要）:**
- `config_page.py`
- `input_page.py`

---

## データの保存場所

- **フォーム設定:** `form_config.json`
- **入力データ:** `input_data.json`

これらのファイルはアプリケーションの実行ディレクトリに自動生成されます。

---

## PySide6版の特徴

### Streamlit版との違い

| 項目 | Streamlit版 | PySide6版 |
|------|-------------|-----------|
| 実行環境 | Webブラウザ | デスクトップアプリ |
| 起動速度 | やや遅い | 高速 |
| オフライン動作 | 要サーバー | 完全オフライン |
| UI | Web風 | ネイティブGUI |
| 配布 | 難しい | 実行ファイル化可能 |

### PySide6版のメリット

- ネイティブなデスクトップアプリケーション
- 完全オフラインで動作
- レスポンスが高速
- 現場のPCに配布しやすい
- データがローカルに保存される（セキュリティ向上）

---

## トラブルシューティング

### PySide6がインストールできない

```bash
pip install --upgrade pip
pip install PySide6
```

### macOSで「開発元を検証できません」と表示される

PySide6は署名済みなので問題ありませんが、もし表示された場合:
1. システム環境設定 > セキュリティとプライバシー
2. 「このまま開く」を選択

### Windowsでウィンドウが小さく表示される

main.py:26の数値を変更してください:
```python
self.setGeometry(100, 100, 1400, 900)  # 幅と高さを調整
```

### 文字化けする場合

各ファイルの先頭に以下が含まれているか確認:
```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
```

---

## 次のステップ（将来の実装予定）

- [ ] PostgreSQL / SQL Server へのDB接続機能
- [ ] データのエクスポート機能（CSV、Excel）
- [ ] データの検索・フィルタリング機能
- [ ] ユーザー認証機能
- [ ] データの編集・削除機能
- [ ] 入力データのバリデーション強化
- [ ] スタンドアロン実行ファイルの作成（PyInstaller使用）

---

## 動作確認手順（例）

1. アプリケーションを起動: `python main.py`
2. 「設定画面」タブで以下の項目を追加:
   - 電圧 (数値, V, 必須, 表示順1)
   - 電流 (数値, A, 必須, 表示順2)
   - 外観 (文字列, -, 必須, 表示順3)
3. 「💾 設定を保存」をクリック
4. 「データ入力」タブに切り替え
5. **追加した3つの項目が自動的に表示されることを確認**
6. 基本情報を入力（日付、品種、ロット番号）
7. 詳細データを入力
   - 電圧: 100.5
   - 電流: 2.3
   - 外観: 良好
8. 「✅ データを登録」をクリック
9. 登録済みデータテーブルに表示されることを確認
10. 「詳細」ボタンで内容を確認

これで動的フォーム生成の仕組みを確認できます！

---

## 実行ファイル化（オプション）

現場のPCに配布する際は、PyInstallerで実行ファイル化できます:

```bash
# PyInstallerをインストール
pip install pyinstaller

# 実行ファイルを作成
pyinstaller --onefile --windowed --name="可変型入力システム" main.py
```

`dist/`フォルダに実行ファイルが生成されます。
